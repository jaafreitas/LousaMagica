<html>
<head>
<meta charset="UTF-8">

<style> body {padding: 0; margin: 0;} </style>
<script>

var tilt = true;
var X = 0;
var Y = 0;
var tam = 20;   // Tamanho
var mat =0;     // Matriz
var sat = 255;  // Saturação
var opa = 255;  // Opacidade/Alpha

function setup() {
  createCanvas(1024, 1024);
  background(0);
  colorMode(HSB);  // para usar HSB em vez de RGB!
  frameRate(30);
  noStroke();

  var connection = new WebSocket('ws://lousa-magica.local:81/', ['arduino']);
  connection.onmessage = function (msg) {
    valor = msg.data.split(' ').map(Number);
    // console.log(msg.data);
    tilt = valor[0] == 1;
    X = valor[1];
    Y = valor[2];
    tam = valor[3];
    mat = valor[4];
    sat = valor[5];
    opa = valor[6];
  };
}

function draw() {
  if (tilt) {
    background(0);  // limpa o canvas com preto
  }
  else {
    // Note modo HSB no setup! (Matiz, Saturação, Brilho, Alfa)
    // Por que tem que multiplicar por 1.4?
    fill(mat * 1.4, sat, 255, opa/255);
    ellipse(X, Y, tam, tam);
  }
}
</script>
<script language="javascript" type="text/javascript" src="p5.min.js"></script>
</head>
</html>
